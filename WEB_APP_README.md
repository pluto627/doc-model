# 🏥 医疗图像分析Web应用使用指南

## 📋 功能介绍

这是一个基于Web的医疗图像分析系统，允许您在浏览器中上传医疗图像和文本描述，使用训练好的AI模型进行分析。

### 主要功能：
- ✅ 上传医疗图像（X光、CT、心电图等）
- ✅ 输入文字描述和问题
- ✅ AI智能分析并提供建议
- ✅ 局域网内多设备访问
- ✅ 数据本地处理，保护隐私

## 🚀 快速启动

### 方法1：使用启动脚本（推荐）

```bash
./start_server.sh
```

### 方法2：手动启动

```bash
# 1. 激活虚拟环境（如果有）
source venv/bin/activate

# 2. 安装依赖
pip install flask pillow

# 3. 启动服务器
python3 app.py
```

## 🌐 访问应用

启动后，服务器会显示访问地址：

```
本地访问: http://localhost:5000
局域网访问: http://192.168.x.x:5000
```

### 在其他设备上访问：

1. 确保设备与服务器在同一局域网内
2. 在浏览器中输入显示的局域网地址
3. 例如：`http://192.168.1.100:5000`

## 📱 使用方法

### 1. 上传图像（可选）
- 点击上传区域选择图像文件
- 或者直接拖拽图像到上传区域
- 支持格式：JPG, PNG, GIF, BMP, WEBP
- 最大文件大小：16MB

### 2. 输入问题描述
在文本框中详细描述：
- 具体症状
- 检查结果数值
- 想要咨询的问题
- 持续时间等

### 3. 获取分析结果
- 点击"开始分析"按钮
- 等待AI处理（通常几秒钟）
- 查看详细的分析建议

## 💡 使用示例

### 示例1：血压咨询
```
文字输入：
我的血压是150/95，需要吃药吗？年龄45岁，最近工作压力大。

AI会分析并提供：
- 血压范围说明
- 生活方式建议
- 是否需要就医的指导
```

### 示例2：检查报告分析
```
图像：上传X光片/CT片
文字输入：
这是我的胸部X光片，医生说有点问题，想了解具体情况。

AI会提供：
- 影像初步分析
- 可能的情况说明
- 进一步检查建议
```

### 示例3：症状咨询
```
文字输入：
最近经常头痛，特别是下午的时候，持续了一周。有时候还感觉眼睛酸。

AI会提供：
- 可能的原因分析
- 缓解建议
- 就医建议
```

## ⚙️ 配置说明

### 修改端口
如果5000端口被占用，可以修改`app.py`最后一行：

```python
app.run(host='0.0.0.0', port=8080, debug=False, threaded=True)
```

### 修改上传大小限制
在`app.py`中修改：

```python
app.config['MAX_CONTENT_LENGTH'] = 32 * 1024 * 1024  # 改为32MB
```

### 使用训练好的模型
确保`config.py`中的`SOURCE_MODEL_PATH`指向正确的模型路径。

## 🔒 安全与隐私

- ✅ 所有数据在本地处理，不上传到外部服务器
- ✅ 图像临时存储在`uploads/`目录
- ✅ 可以定期清理上传的文件
- ✅ 局域网访问，外网无法访问

### 清理上传的文件：

```bash
rm -rf uploads/*
```

## ⚠️ 重要提示

1. **医疗建议仅供参考**：AI分析不能替代专业医生诊断
2. **紧急情况请就医**：如有严重症状，请立即前往医院
3. **定期体检**：保持健康的最好方式是定期体检
4. **隐私保护**：不要上传包含个人身份信息的完整病历

## 🛠️ 故障排除

### 问题1：无法访问局域网地址
- 检查防火墙设置
- 确保设备在同一WiFi网络
- 尝试关闭VPN

### 问题2：模型加载失败
```
显示"MLX不可用，使用模拟模式"
```
- 这是正常的，系统会使用预设的智能响应
- 如需使用实际模型，确保模型文件存在

### 问题3：图像上传失败
- 检查图像大小是否超过16MB
- 确认图像格式是否支持
- 尝试转换为JPG格式后重试

### 问题4：端口被占用
```
Error: Address already in use
```
解决方案：
```bash
# 查找占用端口的进程
lsof -ti:5000

# 结束进程
kill -9 <PID>

# 或者修改app.py使用其他端口
```

## 📊 系统要求

- Python 3.8+
- macOS / Linux / Windows
- 2GB+ 可用内存
- 支持现代浏览器（Chrome, Safari, Firefox, Edge）

## 🔄 更新日志

### v1.0.0 (2024-12-05)
- ✨ 初始版本发布
- 📸 支持图像上传和分析
- 💬 智能文本问答
- 🌐 局域网访问支持
- 🎨 现代化UI设计

## 📞 技术支持

如遇到问题：
1. 查看终端输出的错误信息
2. 检查`uploads/`目录权限
3. 确认Python版本和依赖安装正确

## 📝 开发者信息

- 基于Flask框架开发
- 使用MLX-LM进行模型推理
- 支持Apple Silicon优化
- 响应式Web设计

---

**祝您使用愉快！💙 关爱健康，从科学了解开始。**



